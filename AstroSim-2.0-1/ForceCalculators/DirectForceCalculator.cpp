#include "DirectForceCalculator.h"

// class DirectForceCalculator : public ForceCalculator{
//     public:
//         DirectForceCalculator(GravitationalSystem& s);
//         valtype getForce (const int i, const int coordType) override;
// };

DirectForceCalculator::DirectForceCalculator(GravitationalSystem& s):ForceCalculator(s){}

valtype DirectForceCalculator::getForce(const int i, const int coordType){
    GravitationalBody current_body = s[i];
    valtype der = 0;
    for(auto body : s.bodies){
        if(body.ID == current_body.ID) continue;
        valtype distsq = distSquare(body.position, current_body.position);
        der+= (-(G * current_body.mass * body.mass * (current_body.position[coordType]-body.position[coordType])) *(pow (Q_rsqrt(distsq),3.0)));
    }
    return der;
}
